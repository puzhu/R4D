---
title: "Class 5 - In class exercises"
author: Hari Subhash
date: "Date created: `r Sys.Date()`"
output:
  html_notebook:
    highlight: kate
    smart: yes
    theme: cosmo
    code_folding: show
    df_print: paged
---
**CHEATSHEETS**

1. [Data visualization](https://github.com/rstudio/cheatsheets/blob/master/data-visualization-2.1.pdf)
2. [Data Manipulation](https://github.com/rstudio/cheatsheets/blob/master/data-transformation.pdf)

**KEYBOARD SHORTCUTS**:

1. Assignment operator (<-) is `Alt+-` for Windows and `Option+-` for Mac
2. Insert new code chunk `Ctrl+Alt+I` for Windows and `Command+Option+I` for Mac
3. Run a line of code `Ctrl+Enter` for Windows and `Command+Enter` for Mac
4. Run all the code within a chunk `Ctrl+Shift+Enter` for Windows and `Command+Shift+Enter` for Mac
5. Insert a pipe operator (%>%) `Ctrl+Shift+M` for Windows and `Command+Shift+M` for Mac


##Task Set 1: Create simple charts
1. Create a histogram of arrival delay.
2. Run the following code to create a stacked column chart. Set the argument position for `geom_col()` to "dodge" to display these bars next to each other instead of on top of each other.
```{r}
flights %>% 
    group_by(origin, month) %>% 
    summarise(meanDelay = mean(dep_delay, na.rm = T)) %>% 
    ggplot(aes(x = factor(month), y = meanDelay, fill = origin)) +
    geom_col()
```
4. Create a scatter plot that compares arrival delay with departure delay. How would you describe the relationship between the two variables?
5. Group the data by `day` to calculate the mean departure delay and pipe to a ggplot to create a line chart showing `day` on the x-axis and the mean departure delay on the y-axis. What questions come up when you look at this chart?
```{r}
plotData <- flights %>% 
    group_by(day) %>% 
    summarise(meanDelay = mean(dep_delay, na.rm = T))

ggplot(data = plotData, mapping = aes(x = day, y = meanDelay)) +
    geom_line() +
    geom_text(aes(label = day))

    scale_x_continuous(breaks = 1:31)
```

```{r}
flights %>% 
    group_by(day) %>% 
    summarise(meanDelay = mean(dep_delay, na.rm = T),
              maxDelay = max(dep_delay, na.rm = T),
              nObs = n())
```


```{r}
flights %>% 
    group_by(day) %>% 
    mutate(delayGap = dep_delay - mean(dep_delay, na.rm = T)) %>% 
    filter(delayGap == max(delayGap, na.rm = T)) %>% 
    select(1:3, dep_delay, delayGap) %>% 
    ggplot(aes(x = day, y = delayGap)) +
    geom_line()
```


```{r}
flights %>% 
    filter(dep_delay > 60) %>% 
    ggplot(aes(x = factor(day), y = dep_delay)) +
    geom_boxplot()
```


##Task Set 2: Facets and multiple geoms
1. Create a facetted version of the histogram you made in the previous task set. You can pick a facet of your choice (remember that a facet should be a categorical variable)

```{r}
ggplot(flights, aes(arr_delay)) +
    geom_histogram() +
    facet_wrap(~origin)
```

2. The code below is the same as task 3 in the previous task set. Modify it to create a facetted version of the chart (instead of the stacked bars). Think about what variable you should use to facet. 
```{r}
flights %>% 
    group_by(origin, month) %>% 
    summarise(meanDelay = mean(dep_delay, na.rm = T)) %>% 
    ggplot(aes(x = origin, y = meanDelay, fill = origin)) +
    geom_col() +
    facet_wrap(~month)
```

3. Extend the scatter plot you made in the previous section by adding a `geom_smooth()` to it.
```{r}
ggplot(flights, aes(x = arr_delay, y = dep_delay)) +
    geom_point() +
    geom_smooth()
```


4. How would you make the line generated by `geom_smooth()` linear (i.e. a straight line)
```{r}
ggplot(flights, aes(x = arr_delay, y = dep_delay)) +
    geom_point() +
    geom_smooth(method = "lm")
```

##Task Set 3: Make a pretty plot
1. Take any plot that you made in any of the previous set of tasks and
    + Add axis labels and chart title
    + Any additional aesthetics to make it prettier
    + Choose a theme template from ggthemes (you will have to install it and then load it using `library()` before you can use it.)
    + Make any additional changes you would like to make it more attractive
2. Save this plot using `ggsave()` as a png and share it on the class4 channel.





